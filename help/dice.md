---
description: 各种骰子、跑团相关功能
---

# 骰子功能

#### 掷骰: `.r [骰子表达式]`

* 掷骰指令使用`.r [骰子表达式] [描述]`，如`.r 8d6 火球术`
* 骰子表达式可以使用四则运算`1d20+4`和嵌套表达式`(2d6)d20`，并支持如下扩展函数:
  * 比较: `>/</=/>=/<=/!= [n]` \(e.g. `4d20>=12`\) =&gt; 每个所掷结果与 n 比较并计算成功数
  * 优/劣势掷骰: `ad/da` \(e.g. `1d20ad`\) =&gt; 额外骰一次，取两次结果中最高/最低的结果
  * 取高/取低/弃高/弃低: `kh/kl/dh/dl [n]` \(e.g. `4d20kh3`\) =&gt; 选/弃 n 个最高/最低作结果
  * 升序/降序排序: `sa/sd` \(e.g. `10d20sa`\) =&gt; 掷骰输出结果按升序/降序排列
  * 条件表达式: `if([骰子表达式],[比较],[成功](,[失败]))` \(e.g. `if(1d20,>14,8d6/2,8d6)`\) =&gt; 通过比较，掷\[成功\]，否则掷\[失败\]或 0\(\[失败\]为空时\)
  * 多次掷骰: `[n]{[骰子表达式]}` \(e.g. `6{4d6kh3}`\) =&gt; 掷 n 次对应的表达式
* 输出结果中，每一个结果数字含前缀或后缀:
  * 前缀`$`表示成功，前缀`#`表示失败
  * 后缀`!`表示大成功/大失败，后缀`*`表示该结果被丢弃



#### 随机数发生器: `.gen set [发生器]`

* 目前支持以下随机数发生器，使用`.gen set [序号或名称]`修改个人使用的发生器，使用`.gen show`查看个人正在使用的发生器，使用`.gen list`查看所有支持的随机数发生器
  * 0. CryptoService \# 默认发生器，基于系统加密 API
  * 1. ALF \# 加性延迟斐波那契算法，历史悠久
  * 2. MT19937 \# 梅森旋转算法，相当流行
  * 3. NR3 \# 《Numerical Recipes》的实现
  * 4. XorShift \# XorShift128 算法，速度快
  * 5. Xoshiro \# Xoshiro256\*\* 算法，新兴算法
  * 6. PCG \# PCG32 算法，统计质量好
  * 7. RandomOrg \# Random.Org 提供，基于大气噪音，需网络调用
  * 8. ANUQuantum \# ANU 提供，基于量子真空涨落，需网络调用



#### 暗骰:  `.rh [骰子表达式]`或`.hr set` 

* 群聊中使用`.rh [骰子表达式]`可以进行一次暗骰，暗骰结果会通过私聊发送，而群聊中不会显示掷骰结果
* 群聊中使用.hr set将此群设置为暗骰提示群，与狗条私聊中的掷骰，将会在对应的群聊中发送一次暗骰提示，暗骰提示将显示大致的掷骰次数和合计的骰子个数，数字越大，提示的结果越不精准



#### 骰子宏: `.nr`

* `.nr list` 列出个人所有宏与其值
* `.nr show (@QQ) [宏名称]` 展示个人对应宏的值，如果@了一名群友，将展示他的对应宏的值
* `.nr set [宏名称]=[值]` 为对应的宏设置一个值，可以换行，每行设置一个宏
* `.nr unset [宏名称]` 移除个人对应宏的设置的值
* `.nr as [宏名称](:[算式])` 为对应宏计算值并设置为结果，如果加上`:`，会计算后续算式
* `.nr clear` 清空个人设置的所有宏
* 宏设置成功后，使用掷骰指令时，将自动检测左右带引号的宏的名称，将其替换为设置的值
* ⚔ 骰子宏主要用于快速灵活掷骰、跟踪数值变动的用途
* ⚔ 为了输入方便，使用掷骰指令时，全中文的宏的名称无需左右带上引号即可被替换

